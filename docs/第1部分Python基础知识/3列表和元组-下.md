
#### 列表推导式

循环可以用来生成列表：


```python 
values = [2, 2, 3]
squares = []
for x in values:
    squares.append(x ** 2)
print(squares)  # [4, 4, 9]
```


列表推导式可以使用更简单的方法来创建这个列表：


```python 
values = [3, 8, 10, 14]
squares = [x ** 2 for x in values]
print(squares)  # [9, 64, 100, 196]
```


可以加入条件筛选，在上面的例子中，

假如只想保留列表中不大于8的数的平方：


```python 
squares = [x ** 2 for x in values if x <= 10]
print(squares)  # [9, 64, 100]
```


平方的结果不大于100的：


```python 
squares = [x ** 2 for x in values if x ** 2 <= 80]
print(squares)  # [9, 64]
```


使用推导式生成集合和字典：


```python 
values = [10, 21, 4, 7, 12]
square_set = {x ** 2 for x in values if x <= 10}

print(square_set)  # set([16, 49, 100])
```


```python 
square_dict = {x: x ** 2 for x in values if x <= 10}
print(square_dict)  # {10: 100, 4: 16, 7: 49}
```


计算上面例子中生成的列表中所有元素的和：


```python 
total = sum([x ** 2 for x in values if x < 10])
total  # 65
```


但是，Python会生成这个列表，然后在将它放到垃圾回收机制中（因为没有变量指向它），

这毫无疑问是种浪费。

为了解决这种问题，与range()类似，Python使用产生式表达式来解决这个问题：


```python 
total = sum(x ** 2 for x in values if x < 10)
total  # 65
```


与上面相比，只是去掉了括号，但这里并不会一次性的生成这个列表。


```python 
import time

# 比较一下两者的用时：
x = range(1000000)
t1 = time.time()

total = sum([x ** 3 for x in values if x < 10])
print("list speed: ", time.time() - t1)
```


```python 
t2 = time.time()
total = sum(x ** 3 for x in values if x < 10)
print("comprehension speed:", time.time() - t2)
```


ipython 下可以输入:


```python 
x = range(1000000)
%timeit total = sum([i**2 for i in x])
%timeit total = sum(i**2 for i in x)
```


#### 列表vs字符串

列表是可变的（Mutable）


```python 
a = [1, 2, 3, 4]
a[0] = 100
a.insert(3, 200)
a  # [100, 2, 3, 200, 4]
```


字符串是不可变的（Immutable）:


```python 
s = "hello world"

# 通过索引改变会报错
s[0] = 'k'
```


```python 
s.insert(3, 'm')
```


字符串方法只是返回一个新字符串，并不改变原来的值：


```python 
print(s.replace('world', 'Mars'))  # hello Mars
print(s)  # hello world

# 如果想改变字符串的值，可以用重新赋值的方法：
s = s.replace('world', 'YunYun')
print(s)  # hello YunYun
```



### 元组

与列表相似，元组tuple也是个有序序列，但是元组是不可变的，用()生成。


```python 
a = (10, 11, 12, 13, 14)
print(a)

# 可以索引，切片：
c = a[0]
print(c)

c = a[1:3]
print(c)  # (11, 12)
c
```



单个元素的元组生成

采用下列方式定义只有一个元素的元组：



```python 
a = (10,)
print(a)
print(type(a))  # <type 'tuple'>
```


```python 
a = [1, 2, 3]
b = tuple(a)
print(b)  # (1, 2, 3)
```


由于元组是不可变的，所以只能有一些不可变的方法，

例如计算元素个数 count 和元素位置 index ，用法与列表一样。


```python 
c = a.count(1)
print(c)  # 1

c = a.index(3)
print(c)  # 索引位置为：2
```


#### TIP：
1. 可变数据类型: list, dictionary, set, numpy array, user defined objects
2. 不可变数据类型: integer, float, long, complex, string, tuple, frozenset，强调下 tuple 是不可变的


