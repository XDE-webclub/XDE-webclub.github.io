<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-第6部分模型的网页化部署/文生图模型的部署" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">文生图模型的部署 | xde-web</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xde-webclub.github.io/en/img/github.svg"><meta data-rh="true" name="twitter:image" content="https://xde-webclub.github.io/en/img/github.svg"><meta data-rh="true" property="og:url" content="https://xde-webclub.github.io/en/docs/第6部分模型的网页化部署/文生图模型的部署"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="文生图模型的部署 | xde-web"><meta data-rh="true" name="description" content="文生图目前已经是比较成熟的一个技术了，不同的方案会提供不同的参数，譬如：画面风格、画面尺寸等等，这里我们以百度提供的文生图的官方API为例，来部署一个文生图模型，为了简化这个过程，我们要求效果如下。"><meta data-rh="true" property="og:description" content="文生图目前已经是比较成熟的一个技术了，不同的方案会提供不同的参数，譬如：画面风格、画面尺寸等等，这里我们以百度提供的文生图的官方API为例，来部署一个文生图模型，为了简化这个过程，我们要求效果如下。"><link data-rh="true" rel="icon" href="/en/img/github.svg"><link data-rh="true" rel="canonical" href="https://xde-webclub.github.io/en/docs/第6部分模型的网页化部署/文生图模型的部署"><link data-rh="true" rel="alternate" href="https://xde-webclub.github.io/en/docs/第6部分模型的网页化部署/文生图模型的部署" hreflang="en"><link data-rh="true" rel="alternate" href="https://xde-webclub.github.io/docs/第6部分模型的网页化部署/文生图模型的部署" hreflang="zh"><link data-rh="true" rel="alternate" href="https://xde-webclub.github.io/docs/第6部分模型的网页化部署/文生图模型的部署" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/en/assets/css/styles.1d0085fc.css">
<script src="/en/assets/js/runtime~main.e33bfe61.js" defer="defer"></script>
<script src="/en/assets/js/main.c6f356bf.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><b class="navbar__title text--truncate">首页</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs">Python</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/en/"><b>首页</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/">第1部分Python基础知识</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/第2部分人工智能引言/0读取BMP文件">第2部分人工智能引言</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/第3部分传统算法入门/">第3部分传统算法入门</a><button aria-label="Expand sidebar category &#x27;第3部分传统算法入门&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/第4部分当下前沿人工智能/颜色量化">第4部分当下前沿人工智能</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/第5部分神经网络入门/1前馈神经网络FNN">第5部分神经网络入门</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/en/docs/第6部分模型的网页化部署/项目协作">第6部分模型的网页化部署</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/第6部分模型的网页化部署/项目协作">项目协作</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/第6部分模型的网页化部署/文生图模型的部署">文生图模型的部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/第6部分模型的网页化部署/提升代码工程能力">提升代码工程能力</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">第6部分模型的网页化部署</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">文生图模型的部署</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>文生图模型的部署</h1></header><p>文生图目前已经是比较成熟的一个技术了，不同的方案会提供不同的参数，譬如：画面风格、画面尺寸等等，这里我们以 百度提供的文生图的官方API为例，来部署一个文生图模型，为了简化这个过程，我们要求效果如下。</p>
<p><img decoding="async" loading="lazy" alt="1715442284240" src="/en/assets/images/1715442284240-490779c8e24f561bacb4a6274069e7bc.png" width="339" height="176" class="img_ev3q"></p>
<p>非常简单的一个窗口：一个输入框接收提示词，点击生成按钮，生成一张图片。</p>
<p>这是我们部署的第二个模型，所以我们要重新设计一下：点开主页，是一个提示，可以指向不同模型的部署页面。</p>
<p><img decoding="async" loading="lazy" alt="1715444329881" src="/en/assets/images/1715444329881-76d70614bd21801d2265d51a193db1bb.png" width="421" height="217" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="首页设置">首页设置<a href="#首页设置" class="hash-link" aria-label="Direct link to 首页设置" title="Direct link to 首页设置">​</a></h2>
<p>我们需要一个首页，指向不同模型的部署页面,在下面的路径中创建文件。</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">my_app_name\my_app_name\index_page.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> reflex </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">index</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">heading</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;欢迎使用 网络社模型库!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                width</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;100%&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">link</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;鸢尾花模型识别&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> href</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/knn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">link</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;文生图模型体验&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> href</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/aiimg&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                width</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;100%&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                align</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;center&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                justify</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;center&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="knn模型部署页面">KNN模型部署页面<a href="#knn模型部署页面" class="hash-link" aria-label="Direct link to KNN模型部署页面" title="Direct link to KNN模型部署页面">​</a></h2>
<p>还是按照之前的方法放置模型路径</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">my_app_name\my_app_name\knn_page.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> joblib</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 加载模型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">knn_from_joblib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> joblib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;knn_model.pkl&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> reflex </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">State</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    predicted_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iris_target_names</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;setosa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;versicolor&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;virginica&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">handle_submit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Handle the form submit.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 将字典的值转为浮点数，放置在新的列表中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        iris_example_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">[</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> v </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 使用模型预测</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        predict </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> knn_from_joblib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iris_example_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 将预测结果转为花的名称</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predicted_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">iris_target_names</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">knn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;花萼长度&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sepal_length&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;花萼宽度&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;sepal_width&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;花瓣长度&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;petal_length&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;花瓣宽度&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;petal_width&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;判断&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;submit&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">handle_submit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reset_on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predicted_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="文生图模型部署页面">文生图模型部署页面<a href="#文生图模型部署页面" class="hash-link" aria-label="Direct link to 文生图模型部署页面" title="Direct link to 文生图模型部署页面">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">my_app_name\my_app_name\aiimg_page.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> reflex </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> PIL </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;**加密**&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SECRET_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;**加密**&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_access_token</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用 AK，SK 生成鉴权签名（Access Token）</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :return: access_token，或是None(如果错误)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://aip.baidubce.com/oauth/2.0/token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;grant_type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;client_credentials&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;client_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> API_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SECRET_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;access_token&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/text2image/sd_xl?access_token=&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> get_access_token</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;size&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;768x768&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;n&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;steps&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;sampler_index&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Euler a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Accept&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    base64_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;b64_image&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base64_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BytesIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ImgState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prompt_submit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">form_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;提示词&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;生成&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;submit&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">prompt_submit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reset_on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;100px&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> height</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;auto&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="主程序">主程序<a href="#主程序" class="hash-link" aria-label="Direct link to 主程序" title="Direct link to 主程序">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">my_app_name\my_app_name\my_app_name.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> rxconfig </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> reflex </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> my_app_name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index_page </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> my_app_name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">knn_page </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> knn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> my_app_name</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">aiimg_page </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> aiimg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">App</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_page</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> route</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_page</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">knn</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> route</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/knn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add_page</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">aiimg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> route</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;/aiimg&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="考核">考核<a href="#考核" class="hash-link" aria-label="Direct link to 考核" title="Direct link to 考核">​</a></h2>
<p>基于上面的代码，请你完成以下改进：</p>
<ol>
<li>新增一个输入框，用于接收文生图的补充参数，全部学生需完成。</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">size	string	否	生成图片长宽，默认值 1024x1024，取值范围如下：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 适用头像： [&quot;768x768&quot;, &quot;1024x1024&quot;, &quot;1536x1536&quot;, &quot;2048x2048&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 适用文章配图 ：[&quot;1024x768&quot;, &quot;2048x1536&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 适用海报传单：[&quot;768x1024&quot;, &quot;1536x2048&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 适用电脑壁纸：[&quot;1024x576&quot;, &quot;2048x1152&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 适用海报传单：[&quot;576x1024&quot;, &quot;1152x2048&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">style	string	否	生成风格。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">说明：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">（1）可选值：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Base：基础风格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· 3D Model：3D模型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Analog Film：模拟胶片</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Anime：动漫</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Cinematic：电影</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Comic Book：漫画</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Craft Clay：工艺黏土</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Digital Art：数字艺术</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Enhance：增强</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Fantasy Art：幻想艺术</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Isometric：等距风格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Line Art：线条艺术</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Lowpoly：低多边形</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Neonpunk：霓虹朋克</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Origami：折纸</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Photographic：摄影</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Pixel Art：像素艺术</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">· Texture：纹理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">（2）默认值为Base</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>为了避免在生成图片的过程中，用户等待时间过长，在生成图片的过程中，显示一个加载中的动画并锁定按钮，避免重复发出请求。</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 动画加载</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chakra</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">circular_progress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is_indeterminate</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>条件显示的例子：<a href="https://reflex.dev/docs/library/layout/cond/#cond" target="_blank" rel="noopener noreferrer">https://reflex.dev/docs/library/layout/cond/#cond</a></p>
<p><img decoding="async" loading="lazy" alt="1715487844883" src="data:image/png;base64,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1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwBADHQtAAAx0LUAAMRA1wIAEANdCwDAlS+E/w+kUth+tqpLtwAAAABJRU5ErkJggg==" width="925" height="399" class="img_ev3q">
<img decoding="async" loading="lazy" alt="1715488114948" src="/en/assets/images/1715488114948-0afae11becbebd4e9d7fdec80aa9f4f0.png" width="908" height="324" class="img_ev3q">
<img decoding="async" loading="lazy" alt="1715488029825" src="/en/assets/images/1715488029825-833eb11c141cc39e1eb24c538b7c554f.png" width="991" height="299" class="img_ev3q"></p>
<ol start="3">
<li>仍有余力的同学可以适当美化页面</li>
</ol>
<p>参考答案：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">my_app_name\my_app_name\aiimg_page.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> reflex </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> PIL </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">API_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;**加密**&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SECRET_KEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;**加密**&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_access_token</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    使用 AK，SK 生成鉴权签名（Access Token）</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    :return: access_token，或是None(如果错误)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://aip.baidubce.com/oauth/2.0/token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;grant_type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;client_credentials&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;client_id&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> API_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;client_secret&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SECRET_KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;access_token&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> style</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;Cinematic&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;768x768&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/text2image/sd_xl?access_token=&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> get_access_token</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">prompt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;size&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;n&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;steps&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;sampler_index&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Euler a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> style</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    headers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Accept&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">headers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    base64_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;b64_image&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 解码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base64_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 转为文件流</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BytesIO</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 转为PIL对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image_data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ImgState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">State</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_processing</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image_made</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">prompt_submit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_processing </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_made </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># yield和return的区别：yield不会结束函数，只会把函数内的数据同步到内存中，而return则会结束函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            form_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> form_data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;size&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_processing </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_made </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">yield</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">aiimg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Component</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">form</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;提示词&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;prompt&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;风格&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;style&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        placeholder</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;尺 寸&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;size&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;生成&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;submit&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        disabled</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_processing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">prompt_submit</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reset_on_submit</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">divider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_processing</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 条件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">chakra</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">circular_progress</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is_indeterminate</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 转圈 如果条件为真，则执行（1）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># 如果条件为假，则执行(2)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cond</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image_made</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 条件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        rx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ImgState</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;200px&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> height</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;auto&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token comment" style="color:#999988;font-style:italic"># 如果条件为真，(1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic"># 如果条件为假，则执行(2)留空</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                width</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;100%&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/第6部分模型的网页化部署/项目协作"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">项目协作</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/第6部分模型的网页化部署/提升代码工程能力"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">提升代码工程能力</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#首页设置" class="table-of-contents__link toc-highlight">首页设置</a></li><li><a href="#knn模型部署页面" class="table-of-contents__link toc-highlight">KNN模型部署页面</a></li><li><a href="#文生图模型部署页面" class="table-of-contents__link toc-highlight">文生图模型部署页面</a></li><li><a href="#主程序" class="table-of-contents__link toc-highlight">主程序</a></li><li><a href="#考核" class="table-of-contents__link toc-highlight">考核</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">控江XDE-web</div></div></div></footer></div>
</body>
</html>